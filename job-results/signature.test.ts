import { describe, it, expect } from "vitest";
import { readPrivateKey } from "../testing";

import { ResultsReader } from "./index";

// generated by running:
// openssl rsa -pubin -in testing/public_key.pem -outform DER | openssl dgst -sha256
const PUB_KEY_SIGNATURE =
  "6a9992d6014343f69a9dd5f65a448a4027b3a7eb1a87a9cddd0761bb9e7881a0";

describe("rsa key signature", async () => {
  it("reader should match writer", async () => {
    const privkey = readPrivateKey();

    const reader = new ResultsReader();
    await reader.parseKeys(privkey);

    expect(reader.publicKeyFingerPrint).toBeTruthy();
    expect(reader.publicKeyFingerPrint).toEqual(PUB_KEY_SIGNATURE);
  });
});
